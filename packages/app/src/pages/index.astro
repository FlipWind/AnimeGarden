---
import { getRuntime } from '@astrojs/cloudflare/runtime';

import Layout from '../layouts/Layout.astro';
import Pagination from '../components/Pagination.astro';
import ResourceTable from '../components/ResourceTable.astro';

import type { Env } from '../env';
import { wfetch, fetchResources } from '../fetch';

const runtime = getRuntime<Env>(Astro.request);

const { resources } = await fetchResources(1, { fetch: wfetch(runtime?.env?.worker) });
---

<Layout title="Anime Garden">
  <div class="mt-4vh w-full">
    <ResourceTable resources={resources} />
    <Pagination page={1} href={(page) => `/resources/${page}`} />
  </div>
</Layout>
